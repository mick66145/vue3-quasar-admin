# SD 系統設計文件撰寫風格指南

> **版本：** v1.0
> **更新日期：** 2025-11-12
> **文件類型：** 文件撰寫規範與標準

---

## 📋 目錄

- [1. 概述](#1-概述)
- [2. 文件結構規範](#2-文件結構規範)
- [3. 文件頭部資訊](#3-文件頭部資訊)
- [4. 目錄與導航](#4-目錄與導航)
- [5. 內容撰寫原則](#5-內容撰寫原則)
- [6. 格式化規範](#6-格式化規範)
- [7. API 文件規範](#7-api-文件規範)
- [8. 範例與說明](#8-範例與說明)
- [9. 視覺化元素](#9-視覺化元素)
- [10. 版本控制](#10-版本控制)
- [11. 檢查清單](#11-檢查清單)

---

## 1. 概述

本文件規範了 專案的技術文件撰寫標準，確保所有文件具有一致性、可讀性和實用性。

### 1.1 文件撰寫目標

- ✅ **易於理解**：清晰、簡潔的語言，避免過度技術化的術語
- ✅ **結構一致**：統一的組織結構，方便讀者快速定位資訊
- ✅ **完整詳盡**：涵蓋所有必要資訊，包括範例、錯誤處理、使用情境
- ✅ **視覺友善**：使用表格、流程圖、代碼區塊等提升可讀性
- ✅ **可維護性**：明確的版本記錄，易於更新和追蹤變更

---

## 2. 文件結構規範

### 2.1 標準文件架構

所有 API 功能文件應包含以下基本結構：

```markdown
# [功能名稱] API 文件

> 文件頭部資訊

---

## 📋 目錄

---

## 1. 概述

- 功能簡介
- 核心特性（使用 ✅ 標示）

## 2. 技術規格

- 傳輸協定
- 連線端點
- 支援版本

## 3. [核心功能章節]

- 詳細說明
- Request/Response 格式
- 欄位說明表格
- 範例代碼

## 4. 使用情境範例

- 實際應用場景
- 事件流程圖

## 5. 錯誤處理

- 錯誤代碼對照表
- 處理建議

---

## 版本歷史

---

© 版權聲明
```

### 2.2 章節編號規範

- **一級標題**：使用數字編號（例：`## 1. 概述`）
- **二級標題**：使用數字.數字編號（例：`### 2.1 傳輸協定`）
- **三級標題**：使用數字.數字.數字編號（例：`#### 2.1.1 HTTP 協定`）
- **最多不超過三層**：避免過深的層級結構

### 2.3 檔案命名規範

| 文件類型      | 命名格式                     | 範例                    |
| ------------- | ---------------------------- | ----------------------- |
| 功能 API 文件 | `功能名稱.md`（小寫+連字號） | `chat.md`, `dataset.md` |
| 整合類文件    | `功能-整合類型.md`           | `chat-websocket.md`     |
| 指南類文件    | `主題-guidelines.md`         | `testing-guidelines.md` |
| 架構設計文件  | `主題-architecture.md`       | `rag-architecture.md`   |

---

## 3. 文件頭部資訊

### 3.1 必要資訊

每份文件開頭必須包含以下資訊區塊：

```markdown
> **版本：** v1.0
> **更新日期：** YYYY-MM-DD
> **文件類型：** [文件類型簡述]
```

### 3.2 文件類型範例

- `REST API 整合指南`
- `WebSocket 即時通訊 API 整合指南`
- `系統架構設計文件`
- `開發規範與標準`

### 3.3 頭部分隔線

資訊區塊後必須加上分隔線：

```markdown
---
```

---

## 4. 目錄與導航

### 4.1 目錄格式

使用 emoji 圖示和清晰的層級結構：

```markdown
## 📋 目錄

- [1. 概述](#1-概述)
- [2. 技術規格](#2-技術規格)
  - [2.1 傳輸協定](#21-傳輸協定)
  - [2.2 連線端點](#22-連線端點)
```

### 4.2 錨點命名規則

- 使用小寫
- 中文字之間不加連字號
- 數字和中文之間使用連字號
- 範例：`#1-概述`, `#21-傳輸協定`

---

## 5. 內容撰寫原則

### 5.1 語言風格

| 原則       | 說明                                 | ✅ 正確範例             | ❌ 錯誤範例                             |
| ---------- | ------------------------------------ | ----------------------- | --------------------------------------- |
| 使用現在式 | 描述系統行為使用現在式               | 伺服器會返回錯誤訊息    | 伺服器將會返回錯誤訊息                  |
| 主動語態   | 優先使用主動語態，清晰表達動作主體   | 客戶端發送請求          | 請求被客戶端發送                        |
| 簡潔明確   | 避免冗長的句子，每句話只表達一個概念 | 使用 JWT token 進行認證 | 系統使用 JWT token 來進行身份認證和授權 |
| 一致性術語 | 同一概念使用相同術語                 | 聊天室 (統一使用)       | 聊天室/房間/chat room 混用              |

### 5.2 技術術語

**中英文混用規範：**

- 專有名詞首次出現時使用中英對照：`JSON Web Token (JWT)`
- 後續使用可只用縮寫：`JWT`
- 程式碼相關術語保持英文：`WebSocket`, `API`, `HTTP`, `REST`
- 一般性描述使用中文：「請求」、「回應」、「錯誤」

### 5.3 強調與提示

使用特定格式標示重要資訊：

**重要提示：**

```markdown
**注意事項：**

- 這些錯誤會透過 `rpcError` 事件發送到客戶端
- 收到 401 錯誤時，應引導使用者重新登入
```

**警告訊息：**

```markdown
**IMPORTANT:** 當收到認證錯誤時，應立即停止所有操作並重新驗證。
```

---

## 6. 格式化規範

### 6.1 表格使用

**適用場景：**

- 欄位說明
- 參數列表
- 錯誤代碼對照
- 技術規格比較

**標準格式：**

```markdown
| 欄位名稱 | 類型   | 必填 | 說明                   |
| -------- | ------ | ---- | ---------------------- |
| `id`     | string | ✅   | 唯一識別碼 (UUID 格式) |
| `name`   | string | ✅   | 名稱                   |
| `email`  | string | ❌   | Email (可選)           |
```

**表格規範：**

- 使用 `✅` 表示必填，`❌` 表示選填
- 程式碼相關欄位名稱使用反引號：`` `id` ``
- 對齊使用連字號，確保可讀性
- 每個欄位都必須有清晰的說明

### 6.2 代碼區塊

**標準格式：**

````markdown
​`typescript
interface User {
  id: string;
  name: string;
}
​`
````

**語言標示規範：**

- TypeScript 介面定義：`typescript`
- JavaScript 代碼：`javascript`
- JSON 資料：`json`
- Shell 命令：`bash`
- 流程圖：不使用語言標示或使用 `text`

**範例代碼要求：**

- 必須是可執行的完整代碼
- 包含必要的註解說明
- 使用有意義的變數名稱
- 遵循專案的代碼風格規範

### 6.3 清單格式

**無序清單：**

```markdown
- 第一項
- 第二項
  - 子項目 1
  - 子項目 2
```

**有序清單：**

```markdown
1. 第一步：建立連線
2. 第二步：發送請求
3. 第三步：處理回應
```

**核心特性清單（使用 emoji）：**

```markdown
- ✅ **即時雙向通訊**：使用 WebSocket 技術實現低延遲的即時訊息傳遞
- ✅ **完整的錯誤處理**：標準化錯誤代碼和訊息
```

---

## 7. API 文件規範

### 7.1 API 端點描述

每個 API 端點必須包含：

````markdown
### [HTTP Method] /api/endpoint - 端點名稱

**說明：** [端點功能的簡短描述]

#### Request 格式

​`typescript
interface RequestInterface {
  field: string;
}
​`

#### 欄位說明

| 欄位路徑 | 類型 | 必填 | 說明 |
| -------- | ---- | ---- | ---- |
| ...      | ...  | ...  | ...  |

#### Request 範例

​`javascript
// 實際的請求代碼範例
​`

#### Response 回應

**成功回應 (200 OK)：**

​`json
{
  "statusCode": 200,
  "data": {...}
}
​`

**失敗回應：**

**1. [錯誤類型] ([HTTP Status Code])：**

​`json
{
  "statusCode": 400,
  "error": "BadRequestException",
  "message": ["錯誤訊息"]
}
​`
````

### 7.2 WebSocket 事件描述

```markdown
### 事件名稱 - 事件說明

**事件名稱：** `eventName`

**說明：** [事件觸發時機和用途]

#### Request 格式

[如果是客戶端發送事件]

#### Response 格式

[如果是伺服器推送事件]

#### 欄位說明

[詳細的欄位說明表格]

#### 範例

[實際的代碼範例]

#### 廣播事件

[如果有相關的廣播事件]

#### 使用情境

[何時使用此事件]
```

### 7.3 資料結構定義

**標準格式：**

````markdown
#### [結構名稱] 結構

​`typescript
interface StructureName {
  field1: string;
  field2: number;
  field3?: boolean; // 可選欄位
}
​`

**欄位說明：**

| 欄位名稱 | 類型    | 必填 | 說明            |
| -------- | ------- | ---- | --------------- |
| `field1` | string  | ✅   | 欄位1說明       |
| `field2` | number  | ✅   | 欄位2說明       |
| `field3` | boolean | ❌   | 欄位3說明(可選) |
````

---

## 8. 範例與說明

### 8.1 範例代碼原則

**必須提供：**

1. **完整的可執行範例**：不使用省略號或偽代碼
2. **多種情境範例**：成功、失敗、邊界情況
3. **實際數據範例**：使用真實的資料格式，而非 placeholder

**範例結構：**

````markdown
#### 使用範例

**情境：** [描述此範例的使用場景]

​```javascript
// 步驟 1: [說明]
const result = await api.call();

// 步驟 2: [說明]
if (result.success) {
console.log('成功');
}
​```

**預期結果：**

​`json
{
  "statusCode": 200,
  "data": {...}
}
​`
````

### 8.2 錯誤範例

**每種錯誤類型都要提供：**

- HTTP 狀態碼
- 錯誤類型名稱
- 完整的錯誤回應 JSON
- 觸發原因
- 處理建議

````markdown
**1. 參數驗證錯誤 (400 Bad Request)：**

**觸發原因：** 請求參數格式不正確或缺少必填欄位

​`json
{
  "statusCode": 400,
  "error": "BadRequestException",
  "message": [
    "field1 should not be empty",
    "field2 must be a string"
  ]
}
​`

**處理建議：** 檢查請求參數，確保所有必填欄位都已提供且格式正確
````

---

## 9. 視覺化元素

### 9.1 流程圖

使用 ASCII 字元繪製流程圖：

````markdown
​`
使用者操作
  │
  ├─> 客戶端處理
  │   ├─> 發送請求
  │   └─> 等待回應
  │
  ├─> 伺服器處理
  │   ├─> 驗證請求
  │   ├─> 執行業務邏輯
  │   └─> 返回結果
  │
  └─> 客戶端接收
      ├─> 成功：顯示結果
      └─> 失敗：顯示錯誤
​`
````

**流程圖規範：**

- 使用 `│`, `├─>`, `└─>` 等字元
- 清晰的縮排表示層級關係
- 每個步驟都要有明確的說明
- 包含成功和失敗的分支

### 9.2 時序圖

````markdown
​`
[客戶端]                    [伺服器]
   │                           │
   ├─── 請求 ──────────────────>│
   │                           │ (處理中)
   │<──── 回應 ─────────────────┤
   │                           │
​`
````

### 9.3 Emoji 使用指南

**標準 Emoji：**

| Emoji | 使用場景           | 範例                    |
| ----- | ------------------ | ----------------------- |
| 📋    | 目錄標題           | `## 📋 目錄`            |
| ✅    | 成功、支援、必填   | `✅ 即時雙向通訊`       |
| ❌    | 失敗、不支援、選填 | `❌ 選填欄位`           |
| ⚠️    | 警告、注意事項     | `⚠️ 重要：請先完成認證` |
| 🔧    | 設定、配置         | `🔧 環境設定`           |
| 🚀    | 快速開始、部署     | `🚀 快速開始`           |
| 📝    | 備註、說明         | `📝 備註說明`           |
| 🔐    | 安全、認證         | `�� JWT 認證`           |

**注意：** 不要過度使用 emoji，只在必要時使用以增強可讀性。

---

## 10. 版本控制

### 10.1 版本號規範

採用語意化版本號：`v[Major].[Minor]`

- **Major（主版本號）**：重大更新、破壞性變更
- **Minor（次版本號）**：新增功能、向後相容的修改

範例：

- `v1.0`：初版發布
- `v1.1`：新增功能或小幅修改
- `v2.0`：重大更新或架構變更

### 10.2 版本歷史表格

文件末尾必須包含版本歷史：

```markdown
---

**文件版本歷史：**

| 版本 | 日期       | 說明                        |
| ---- | ---------- | --------------------------- |
| v1.2 | 2025-11-11 | 新增 aiError 事件說明       |
| v1.1 | 2025-11-10 | 新增 JWT 認證錯誤碼詳細說明 |
| v1.0 | 2025-11-06 | 初版發布                    |
```

### 10.3 更新時的處理

**當更新文件時：**

1. 更新文件頭部的版本號和日期
2. 在版本歷史表格中新增一行記錄
3. 在相關章節標註變更內容（如適用）

**標註變更：**

```markdown
**🆕 v1.1 新增：** 此章節為新增內容

**⚠️ v1.1 變更：** 此參數的行為已在 v1.1 中變更
```

---

## 11. 檢查清單

### 11.1 文件撰寫檢查清單

在提交文件前，請確認以下項目：

**基本結構：**

- [ ] 包含文件頭部資訊（版本、日期、類型）
- [ ] 包含完整的目錄
- [ ] 章節編號正確且連續
- [ ] 所有目錄連結可正常跳轉

**內容完整性：**

- [ ] 概述章節清晰說明功能用途
- [ ] 所有 API 端點都有完整的 Request/Response 範例
- [ ] 所有欄位都有詳細說明表格
- [ ] 包含錯誤處理和錯誤代碼說明
- [ ] 提供實際使用情境範例

**格式規範：**

- [ ] 表格格式正確，欄位對齊
- [ ] 代碼區塊指定正確的語言標示
- [ ] Emoji 使用適當且一致
- [ ] 中英文之間有適當的空格（程式碼除外）

**範例代碼：**

- [ ] 所有代碼範例都是完整可執行的
- [ ] 範例使用真實的資料格式
- [ ] 包含成功和失敗的範例
- [ ] 代碼註解清晰易懂

**視覺化：**

- [ ] 複雜流程有流程圖說明
- [ ] 事件序列有時序圖說明
- [ ] 使用表格呈現結構化資料

**版本控制：**

- [ ] 版本號遵循規範
- [ ] 更新日期正確
- [ ] 版本歷史表格已更新

### 11.2 程式碼範例檢查清單

**JavaScript/TypeScript 範例：**

- [ ] 使用 `const`/`let` 而非 `var`
- [ ] 使用箭頭函數（適當時）
- [ ] 包含適當的錯誤處理
- [ ] 變數命名清晰且有意義
- [ ] 遵循專案的代碼風格

**JSON 範例：**

- [ ] 格式正確，可被 JSON parser 解析
- [ ] 使用雙引號包圍鍵和字串值
- [ ] 適當的縮排（2 或 4 空格）
- [ ] 包含所有必要欄位
- [ ] 使用真實的資料類型和格式（UUID、ISO 8601 日期等）

---

## 附錄 A：參考範例

### 完整的功能文件範例

請參考以下文件作為標準範例：

- [Chat WebSocket API](./features/chat.md)：WebSocket 整合文件的完整範例
- [RAG Architecture](./features/rag-architecture.md)：架構設計文件範例

### 常用術語對照表

| 中文         | 英文           | 說明                              |
| ------------ | -------------- | --------------------------------- |
| 應用程式介面 | API            | Application Programming Interface |
| 請求         | Request        | 客戶端向伺服器發送的請求          |
| 回應         | Response       | 伺服器返回的回應                  |
| 端點         | Endpoint       | API 的特定 URL 路徑               |
| 參數         | Parameter      | 請求中的參數                      |
| 欄位         | Field          | 資料結構中的欄位                  |
| 驗證         | Validation     | 資料驗證                          |
| 認證         | Authentication | 身份認證                          |
| 授權         | Authorization  | 權限授權                          |
| 廣播         | Broadcast      | 向多個客戶端發送訊息              |

---

## 附錄 B：文件模板

### API 功能文件模板

```markdown
# [功能名稱] API 文件

> **版本：** v1.0
> **更新日期：** YYYY-MM-DD
> **文件類型：** REST API 整合指南

---

## 📋 目錄

- [1. 概述](#1-概述)
- [2. 技術規格](#2-技術規格)
- [3. API 端點](#3-api-端點)
- [4. 使用情境範例](#4-使用情境範例)
- [5. 錯誤處理](#5-錯誤處理)

---

## 1. 概述

[功能的簡短說明]

本文件說明 [功能名稱] API 的串接方式，提供以下功能：

- ✅ **[核心功能1]**：[說明]
- ✅ **[核心功能2]**：[說明]
- ✅ **[核心功能3]**：[說明]

---

## 2. 技術規格

### 2.1 基本資訊

| 項目         | 說明       |
| ------------ | ---------- |
| **協定**     | HTTP/HTTPS |
| **資料格式** | JSON       |
| **字元編碼** | UTF-8      |

### 2.2 API 端點

- DEV環境：`https://api-ai-dataset.dev.mouth.team`
- BETA環境：`https://api-ai-dataset.demo.mouth.team`
- PROD環境：[待定]

---

## 3. API 端點

### 3.1 [端點名稱]

[參考 7.1 API 端點描述規範]

---

## 4. 使用情境範例

### 4.1 情境一：[情境名稱]

[詳細說明]

---

## 5. 錯誤處理

### 5.1 錯誤代碼對照表

| HTTP Status | 錯誤類型    | 說明         | 處理建議     |
| ----------- | ----------- | ------------ | ------------ |
| 200         | Success     | 操作成功     | 繼續正常流程 |
| 400         | Bad Request | 請求參數錯誤 | 檢查請求參數 |

---

**文件版本歷史：**

| 版本 | 日期       | 說明     |
| ---- | ---------- | -------- |
| v1.0 | YYYY-MM-DD | 初版發布 |

---

**© 2025 Sys AI Dataset API. All rights reserved.**
```

---

## 附錄 C：常見問題

### Q1: 何時應該建立新文件？

**A:** 在以下情況下應建立獨立的文件：

- 新增獨立的功能模組
- 新的 API 端點群組（超過 3 個相關端點）
- 新的整合方式（如 WebSocket、GraphQL）
- 重要的架構設計或技術決策

### Q2: 文件應該放在哪裡？

**A:** 遵循以下目錄結構：

- `docs/features/`：功能 API 文件
- `docs/`：指南、規範類文件
- `docs/architecture/`：架構設計文件（如需要）

### Q3: 如何處理多語言文件？

**A:** 目前專案以繁體中文為主：

- 保持技術術語的英文原文
- 重要的專有名詞首次出現時提供中英對照
- 代碼範例中的註解使用中文

### Q4: 文件更新頻率？

**A:**

- API 變更時：立即更新相關文件
- 功能新增時：同步撰寫文件
- 錯誤修正時：更新錯誤處理章節
- 定期審查：每季度檢視並更新過時內容

---

**文件版本歷史：**

| 版本 | 日期       | 說明                                    |
| ---- | ---------- | --------------------------------------- |
| v1.0 | 2025-11-12 | 初版發布，基於 chat.md 建立文件撰寫標準 |

---

**© 2025 Sys AI Dataset API Documentation Team. All rights reserved.**
